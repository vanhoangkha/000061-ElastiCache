[
{
	"uri": "/",
	"title": "Amazon ElastiCache - Redis",
	"tags": [],
	"description": "",
	"content": "Overview In this lab, you\u0026rsquo;ll learn the basics and practice hands-on lab of Amazon ElastiCache - Redis service.\nContent  Introduction Preparation Create ElastiCache cluster Use AWS SDK to write and read to ElastiCache Cleanup resources  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.5-connect-to-the-cluster_s-node/3.5.1-redis-cluster-mode-disabled-cluster_s-endpoints-console/",
	"title": "Cluster Mode Disabled",
	"tags": [],
	"description": "",
	"content": "If a Redis cluster (cluster mode disabled) has only one node, the node\u0026rsquo;s endpoint is used for both reading and writing. If a Redis cluster has multiple nodes, there are three types of endpoints: primary endpoint, the reader endpoint and the node endpoints.\nPrimary endpoint is the DNS name that always resolves to the primary node in the cluster. The primary endpoint is immune to changes to your cluster, such as promoting a read replica for the primary role. For write operations, you should connect your applications to the endpoint.\nThe Reader endpoint will equally divide connections to the endpoint among all read replicas in the ElastiCache for Redis cluster. Additional factors such as when an application creates connections or how an application (reuses) connections will determine traffic distribution. Reader endpoints keep up with cluster changes in real time as replicas are added or removed. You can ElastiCache for Redis clusterâ€™s multiple read replicas in different AWS Availability Zones (AZ) to ensure high availability of reader endpoints.\nFor read operations, applications can also connect to any node in the cluster. Unlike primary endpoints, node endpoints resolve to specific endpoints. If you make changes in your cluster, such as adding or removing replicas, you must update the node endpoints in your application.\nTo find a Redis (cluster mode disabled) cluster\u0026rsquo;s endpoints   Sign in to the AWS Management Console and open the ElastiCache console at https://console.aws.amazon.com/elasticache/.\n  From the navigation pane, select Redis clusters. The Redis clusters screen will appear with a list of Redis (cluster mode disabled) and Redis (cluster mode enabled) clusters.\n   To find the Primary and/or Reader endpoints of the cluster, select the name of the cluster.\n  If Redis (cluster mode disabled) cluster has replica nodes, you can find replica node endpoints of the cluster by selecting the name of the cluster. The nodes screen appears with each node in the cluster, primary and replicas, listed with its endpoint.\n  To copy an endpoint to your clipboard:    One endpoint at a time, find and mark the endpoint you want to clone.\n  Right-click the highlighted endpoint, then select Copy from the context menu. The marked endpoint is now copied to your clipboard.\n  In-transit encryption not enabled\nclusterName.xxxxxx.nodeId.regionAndAz.cache.amazonaws.com:port\rredis-01.7abc2d.0001.usw2.cache.amazonaws.com:6379\rIn-transit encryption enabled\nmaster.clusterName.xxxxxx.regionAndAz.cache.amazonaws.com:port\rmaster.ncit.ameaqx.use1.cache.amazonaws.com:6379\r"
},
{
	"uri": "/4-sdkelasticache/4.2-connecting-to-elasticache/4.2.1-connecting-to-a-cluster-mode-disabled-cluster/",
	"title": "Connecting to a cluster (mode disabled cluster)",
	"tags": [],
	"description": "",
	"content": "Connect to a cluster (cluster mode disable)   Create a python file named ConnectClusterModeDisabled.py.\n  Copy the following program and paste it into the file named ConnectClusterModeDisabled.py.\n  from redis import Redis\rimport logging\rlogging.basicConfig(level=logging.INFO)\rredis = Redis(host='primary.xxx.yyyyyy.zzz1.cache.amazonaws.com', port=6379, decode_responses=True, ssl=True, username='myuser', password='MyPassword0123456789')\rif redis.ping():\rlogging.info(\u0026quot;Connected to Redis\u0026quot;)\rTo run the program, enter the following command:  python ConnectClusterModeDisabled.py\rIf the program cannot run, use the following command:\npython \u0026quot;ConnectClusterModeDisabled.py file path\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/4.1-creating-elasticache-clusters-and-users/4.1.1-create-a-cluster-mode-disabled-cluster/",
	"title": "Create a cluster (mode disabled cluster)",
	"tags": [],
	"description": "",
	"content": "Create a cluster (cluster mode disable)  Create python file CreateClusterModeDisabledCluster.py Copy the following program and paste it into the CreateClusterModeDisabledCluster.py file.  import boto3\rimport logging\rlogging.basicConfig(level=logging.INFO)\rclient = boto3.client('elasticache')\rdef create_cluster_mode_disabled(CacheNodeType='cache.t3.small',EngineVersion='6.0',NumCacheClusters=2,ReplicationGroupDescription='Sample cache cluster',ReplicationGroupId=None):\r\u0026quot;\u0026quot;\u0026quot;Creates an Elasticache Cluster with cluster mode disabled\rReturns a dictionary with the API response\r:param CacheNodeType: Node type used on the cluster. If not specified, cache.t3.small will be used\rRefer to https://docs.aws.amazon.com/AmazonElastiCache/latest/red-ug/CacheNodes.SupportedTypes.html for supported node types\r:param EngineVersion: Engine version to be used. If not specified, latest will be used.\r:param NumCacheClusters: Number of nodes in the cluster. Minimum 1 (just a primary node) and maximun 6 (1 primary and 5 replicas).\rIf not specified, cluster will be created with 1 primary and 1 replica.\r:param ReplicationGroupDescription: Description for the cluster.\r:param ReplicationGroupId: Name for the cluster\r:return: dictionary with the API results\r\u0026quot;\u0026quot;\u0026quot;\rif not ReplicationGroupId:\rreturn 'ReplicationGroupId parameter is required'\rresponse = client.create_replication_group(\rAutomaticFailoverEnabled=True,\rCacheNodeType=CacheNodeType,\rEngine='redis',\rEngineVersion=EngineVersion,\rNumCacheClusters=NumCacheClusters,\rReplicationGroupDescription=ReplicationGroupDescription,\rReplicationGroupId=ReplicationGroupId,\rSnapshotRetentionLimit=30,\r)\rreturn response\rif __name__ == '__main__':\r# Creates an Elasticace Cluster mode disabled cluster, based on cache.m6g.large nodes, Redis 6, one primary and two replicas\relasticacheResponse = create_cluster_mode_disabled(\r#CacheNodeType='cache.m6g.large',\rEngineVersion='6.0',\rNumCacheClusters=3,\rReplicationGroupDescription='Redis cluster mode disabled with replicas',\rReplicationGroupId='redis202104053'\r)\rlogging.info(elasticacheResponse)\rResult as shown\nTo run the program, enter the following command on the Windows Command Prompt:  python CreateClusterModeDisabledCluster.py\rIf the program cannot run, use the following command:\n\rpython \u0026quot;CreateClusterModeDisabledCluster.py file path\u0026quot;\rCreate a cluster (cluster mode disable) with TLS and RBAC  To ensure security, you can use Transport Layer Security (TLS) and Role-Based Access Control (RBAC) when creating a cluster (cluster mode disable). Unlike Redis AUTH, where all authenticated clients have full replication group access if their tokens are authenticated, RBAC allows you to control cluster access through user groups. These user groups are designed as a way to organize access to replication groups.   Create a python file named ClusterModeDisabledWithRBAC.py Copy the following program and paste it into the file named ClusterModeDisabledWithRBAC.py.  import boto3\rimport logging\rlogging.basicConfig(level=logging.INFO)\rclient = boto3.client('elasticache')\rdef create_cluster_mode_disabled_rbac(CacheNodeType='cache.t3.small',EngineVersion='6.0',NumCacheClusters=2,ReplicationGroupDescription='Sample cache cluster',ReplicationGroupId=None, UserGroupIds=None, SecurityGroupIds=None,CacheSubnetName):\r\u0026quot;\u0026quot;\u0026quot;Creates an Elasticache Cluster with cluster mode disabled and RBAC\rReturns a dictionary with the API response\r:param CacheNodeType: Node type used on the cluster. If not specified, cache.t3.small will be used\rRefer to https://docs..amazon.com/AmazonElastiCache/latest/red-ug/CacheNodes.SupportedTypes.html for supported node types\r:param EngineVersion: Engine version to be used. If not specified, latest will be used.\r:param NumCacheClusters: Number of nodes in the cluster. Minimum 1 (just a primary node) and maximun 6 (1 primary and 5 replicas).\rIf not specified, cluster will be created with 1 primary and 1 replica.\r:param ReplicationGroupDescription: Description for the cluster.\r:param ReplicationGroupId: Mandatory name for the cluster.\r:param UserGroupIds: Mandatory list of user groups to be assigned to the cluster.\r:param SecurityGroupIds: List of security groups to be assigned. If not defined, default will be used\r:param CacheSubnetGroupName: subnet group where the cluster will be placed. If not defined, default will be used.\r:return: dictionary with the API results\r\u0026quot;\u0026quot;\u0026quot;\rif not ReplicationGroupId:\rreturn {'Error': 'ReplicationGroupId parameter is required'}\relif not isinstance(UserGroupIds,(list)):\rreturn {'Error': 'UserGroupIds parameter is required and must be a list'}\rparams={'AutomaticFailoverEnabled': True,\r'CacheNodeType': CacheNodeType,\r'Engine': 'redis',\r'EngineVersion': EngineVersion,\r'NumCacheClusters': NumCacheClusters,\r'ReplicationGroupDescription': ReplicationGroupDescription,\r'ReplicationGroupId': ReplicationGroupId,\r'SnapshotRetentionLimit': 30,\r'TransitEncryptionEnabled': True,\r'UserGroupIds':UserGroupIds\r}\r# defaults will be used if CacheSubnetGroupName or SecurityGroups are not explicit.\rif isinstance(SecurityGroupIds,(list)):\rparams.update({'SecurityGroupIds':SecurityGroupIds})\rif CacheSubnetGroupName:\rparams.update({'CacheSubnetGroupName':CacheSubnetGroupName})\rresponse = client.create_replication_group(**params)\rreturn response\rif __name__ == '__main__':\r# Creates an Elasticace Cluster mode disabled cluster, based on cache.m6g.large nodes, Redis 6, one primary and two replicas.\r# Assigns the existent user group \u0026quot;mygroup\u0026quot; for RBAC authentication\rresponse=create_cluster_mode_disabled_rbac(\rCacheNodeType='cache.m6g.large',\rEngineVersion='6.0',\rNumCacheClusters=3,\rReplicationGroupDescription='Redis cluster mode disabled with replicas',\rReplicationGroupId='redis202104',\rUserGroupIds=[\r'mygroup'\r],\rSecurityGroupIds=[\r'sg-7cc73803'\r],\rCacheSubnetGroupName='default'\r)\rlogging.info(response)\rTo run the program, enter the following command:  python ClusterModeDisabledWithRBAC.py\rIf the program cannot run, use the following command:\npython \u0026quot;file path ClusterModeDisabledWithRBAC.py\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/4.1-creating-elasticache-clusters-and-users/",
	"title": "Create Elasticache cluster",
	"tags": [],
	"description": "",
	"content": "Overview The following lab uses boto3 SDK for ElastiCache management operations (cluster or user creation) and redis-py / redis-py-cluster for data processing.\nContent  Create a cluster (mode disabled cluster) Create a cluster (mode disabled cluster) with TLS and RBAC Create a cluster (mode enabled cluster) Create a cluster (mode enabled cluster) with TLS and RBAC Check User Groups  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.1-create-a-subnet-group/",
	"title": "Create subnet group",
	"tags": [],
	"description": "",
	"content": "\rBefore you create a cluster, you must first create a subnet group.\n\rOverview  A cache subnet group is a collection of subnet groups that you may want to specify for your cache clusters in the VPC. When launching a cache cluster in VPC, you need to select a cache subnet group. ElastiCache then uses that cache subnet group to assign IP addresses in that subnet group to each cache node in the cluster. When you create a new subnet group, note the number of available IP addresses. If the subnet group has very few available IP addresses, you may be limited in the number of nodes you can add to the cluster. To get around this, you can assign multiple subnets to a subnet group so that you have a sufficient number of IP addresses in the Availability Zone of the cluster. Thereby you can add more nodes to your cluster.  Content  3.1.1 Create a subnet group using Console 3.1.2 Create a subnet group using AWS CLI  "
},
{
	"uri": "/2-prerequiste/2.1-create-accesskey/",
	"title": "Generate AWS Access Key",
	"tags": [],
	"description": "",
	"content": "Generate access keys for IAM users  Sign in to the AWS Management Console and open the IAM console at IAM console.   In the navigation bar, select Users.\n  Select the name of the user whose access key you want to create, and then select the Security credentials tab.\n  In the Access keys section, select Create access key.  To view the new access key, select Show. Your login information should look like this:  Access key ID: AKIAIOSFODNN7EXAMPLE\rSecret access key: wJalrXUtnFEMI / K7MDENG / bPxRfiCYEXAMPLEKEY``\r To download the key pair, select Download .csv file.\n  After you download the .csv file, select Close\n  "
},
{
	"uri": "/1-introduce/",
	"title": "Introduction",
	"tags": [],
	"description": "",
	"content": "Overview Amazon ElastiCache is a service that makes it easy to set up, manage, and scale data storage in a distributed memory or cache environment. It provides a high-performance, scalable and cost-effective caching solution. It also eliminates the complexity involved in deploying and managing distributed cache environments.\nElastiCache for Redis has many features:\n Automatically detect and recover from node failures. Redis (cluster mode enabled) supports partitioning your data up to 500 shards. Availability Zone locations of nodes and clusters are flexible for increased fault tolerance. Integrates with other AWS services such as Amazon EC2, Amazon CloudWatch, AWS CloudTrail, and Amazon SNS, providing a high-performance and highly secure managed in-memory caching solution. ElastiCache for Redis manages backups, patching, automatic error detection and recovery.  Clusters The basic component of ElastiCache for Redis is called a cluster.\nA cluster is a collection of one or more cache nodes, all running one instance of the Redis cache engine software.\nWhen you create a cluster, you specify the engine and version for all nodes to use. Your ElastiCache for Redis instances are designed to be accessible through Amazon EC2 instances. You can create and modify a cluster using the AWS CLI, ElastiCache for Redis API, or the AWS Management Console.\n  Each ElastiCache for Redis cluster runs an instance of the Redis engine. Each Redis engine version has its own supported features. In addition, each Redis engine instance has a set of parameters in a parameter group that control the behavior of the clusters it manages.\n  The compute capacity and memory capacity of a cluster is determined by its instance or node or class. You can choose the type of node that best meets your needs. If your needs change over time, you can change the node type.\n  You can also take advantage of data hierarchy considering your node type needs. Data rating is a feature where some of the least-used data is stored on disk to minimize memory limitations on applications that can tolerate additional latency.\n  There are two types of node cluster storage: Standard and memory-optimized.\n  They vary in performance and price characteristics, allowing you to tailor performance and storage costs to your needs.\n  You can run a cluster on a virtual private cloud (VPC) using the Amazon Virtual Private Cloud (Amazon VPC) service. When you use a VPC, you have control over your virtual network environment. You can choose your own IP address range, create subnet groups, and configure routing lists and access control. ElastiCache manages backups, software patching, automatic failure detection and recovery.(No extra cost to run your cluster in VPC).\n  ElastiCache nodes  Node is the smallest building block of the ElastiCache implementation. A node can exist in isolation or in some relationship with other nodes. Node is a fixed-size piece of RAM that is attached to the network. Each node runs an instance of the engine, and the version was selected when you created your cluster. If needed, you can scale the nodes in a cluster up or down to a different instance type. Every node in a cluster is the same instance type and runs the same cache engine. Each cache node has its own Domain Name Service (DNS) port and name.  ElastiCache for Redis shards  A Redis shard (called a node group in the API and CLI) is a group of one to six related nodes. A Redis cluster (cluster mode disabled) always has a shard. Redis clusters (cluster mode enabled) can have up to 500 shards, with your data partitioned across shards. The node or shard limit can be increased to a maximum of 500 per cluster if the Redis engine version is 5.0.6 or higher. Make sure there are enough available IP addresses to accommodate the increase.  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.1-create-a-subnet-group/3.1.1-useconsole/",
	"title": "Use Console",
	"tags": [],
	"description": "",
	"content": "Create subnet group using Console  Sign in to the AWS Management Console and open the ElastiCache console at https://console.aws.amazon.com/elasticache/.   In the navigation list, select Subnet Groups.\n  Select Create Subnet Group.\n  In the Create Subnet Group wizard, do the following. When all settings are as you want, select Create .    In the Name box, enter a name for your subnet group.\n  In the Description box, enter a description for your subnet group.\n  In the VPC ID box, select the Amazon VPC you created.\n  In the Availability Zone and Subnet ID list, select Availability Zone and Subnet ID of your private subnet, then select Add.\n  Your new subnet group appears in the Subnet Groups list of the ElastiCache dashboard. At the bottom of the window, you can select the subnet group name to see details, such as all the subnets associated with this group.  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.2-create-a-clustercluster-mode-disabled/3.2.1-use-console/",
	"title": "Use Console",
	"tags": [],
	"description": "",
	"content": "Create a cluster using Console   Sign in to the AWS Management Console and open the Amazon ElastiCache console at https://console.aws.amazon.com/elasticache/.\n  From the list in the upper right corner, select the AWS Region in which you want to launch this cluster.\n  Select Redis clusters from the navigation pane.\n  Select Create Redis cluster.\n   For Choose a cluster creation method, select Configure and create a new cluster\n  For Cluster mode, select Disabled\n  Fill in Cluster info section:    In Name , enter a name for your cluster.\n  In Description, enter a description for this clsuter.\n  For Location, select AWS Cloud.  For Cluster settings   Engine version: select 6.2 Port: select 6379 Parameter groups: select default.redis6.x Node type: select cache.r6g.large Number of replicas: select 2  For Subnet group settings:    In Subnet groups select Choose existing subnet group and select the subnet group created in step 3.1 Create a subnet group\n  In Associated subnets, select Availability Zone and Subnet ID\n  For Availability Zone placements, select Specify Availability Zone Select Next  For Advanced settings:   Selected security groups: select security group   In Backup, select Enable automatic backups  Backup retention period: choose 1 Backup window: No preference     In Maintenance:  Maintenance window: select No preference Topic for Amazon SNS notification: select existing Amazon Resource Name (ARN)     In Logs:  Slow logs: Select Enable Log format: select Text Log destination type: select CloudWatch Logs Log destination: select Choose existing log group Log group name: select log group name    Review and select Create  Wait a few minutes for initialization and results after creating the cluster  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.5-connect-to-the-cluster_s-node/3.5.2-redis-cluster-mode-enabled-cluster-console/",
	"title": "Cluster Mode Enabled",
	"tags": [],
	"description": "",
	"content": "Use Configuration Endpoint for both read and write operations. Redis determines which node of the cluster to access.\nThe following procedure demonstrates how to find and clone Redis (cluster mode enabled) cluster endpoints.\nFind node endpoints for a Redis (cluster mode enabled) cluster   Sign in to the AWS Management Console and open the ElastiCache console at https://console.aws.amazon.com/elasticache/.\n  From the navigation pane, select Redis clusters. A list of clusters running any version of Redis will appear.\n  From the list of clusters, select the cluster name of a cluster. The shard page opens.\n  Select the name of the shard you want the node\u0026rsquo;s endpoint to. The list of shard nodes appears with each node\u0026rsquo;s endpoint.  Locate the Endpoint column and read the endpoint for each node.  In-transit encryption not enabled\nclusterName.xxxxxx.regionAndAz.cache.amazonaws.com:port\rrce.ameaqx.use1.cache.amazonaws.com:6379\rIn-transit encryption enabled\nclustercfg.clusterName.xxxxxx.regionAndAz.cache.amazonaws.com:port\rclustercfg.rce.ameaqx.use1.cache.amazonaws.com:6379\r"
},
{
	"uri": "/4-sdkelasticache/4.2-connecting-to-elasticache/4.2.2-connecting-to-a-cluster-mode-enabled-cluster/",
	"title": "Connecting to a cluster (mode enabled cluster)",
	"tags": [],
	"description": "",
	"content": "Connect to a cluster (cluster mode enable)  Create a python file named ConnectClusterModeEnabled.py. Copy the following program and paste it into the file named ConnectClusterModeEnabled.py.  from rediscluster import RedisCluster\rimport logging\rlogging.basicConfig(level=logging.INFO)\rredis = RedisCluster(startup_nodes=[{\u0026quot;host\u0026quot;: \u0026quot;xxx.yyy.clustercfg.zzz1.cache.amazonaws.com\u0026quot;,\u0026quot;port\u0026quot;: \u0026quot;6379\u0026quot;}], decode_responses=True,skip_full_coverage_check=True)\rif redis.ping():\rlogging.info(\u0026quot;Connected to Redis\u0026quot;)\rTo run the program, enter the following command:  python ConnectClusterModeEnabled.py\rIf the program cannot run, use the following command:\npython \u0026quot;ConnectClusterModeEnabled.py file path\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/4.2-connecting-to-elasticache/",
	"title": "Connecting to Elasticache",
	"tags": [],
	"description": "",
	"content": "Overview The following lab uses the Redis client to connect to ElastiCache.\nContent  Connect to a cluster (cluster mode disable) Connect to a cluster (cluster mode enable)  "
},
{
	"uri": "/4-sdkelasticache/4.1-creating-elasticache-clusters-and-users/4.1.2-create-a-cluster-mode-enabled-cluster/",
	"title": "Create a cluster (mode enabled cluster)",
	"tags": [],
	"description": "",
	"content": "Create a cluster (cluster mode enable)  Create a python file named ClusterModeEnabled.py Copy the following program and paste it into the file named ClusterModeEnabled.py.  import boto3\rimport logging\rlogging.basicConfig(level=logging.INFO)\rclient = boto3.client('elasticache')\rdef create_cluster_mode_enabled(CacheNodeType='cache.t3.small',EngineVersion='6.0',NumNodeGroups=1,ReplicasPerNodeGroup=1, ReplicationGroupDescription='Sample cache with cluster mode enabled',ReplicationGroupId=None):\r\u0026quot;\u0026quot;\u0026quot;Creates an Elasticache Cluster with cluster mode enabled\rReturns a dictionary with the API response\r:param CacheNodeType: Node type used on the cluster. If not specified, cache.t3.small will be used\rRefer to https://docs..amazon.com/AmazonElastiCache/latest/red-ug/CacheNodes.SupportedTypes.html for supported node types\r:param EngineVersion: Engine version to be used. If not specified, latest will be used.\r:param NumNodeGroups: Number of shards in the cluster. Minimum 1 and maximun 90.\rIf not specified, cluster will be created with 1 shard.\r:param ReplicasPerNodeGroup: Number of replicas per shard. If not specified 1 replica per shard will be created.\r:param ReplicationGroupDescription: Description for the cluster.\r:param ReplicationGroupId: Name for the cluster\r:return: dictionary with the API results\r\u0026quot;\u0026quot;\u0026quot;\rif not ReplicationGroupId:\rreturn 'ReplicationGroupId parameter is required'\rresponse = client.create_replication_group(\rAutomaticFailoverEnabled=True,\rCacheNodeType=CacheNodeType,\rEngine='redis',\rEngineVersion=EngineVersion,\rReplicationGroupDescription=ReplicationGroupDescription,\rReplicationGroupId=ReplicationGroupId,\r# Creates a cluster mode enabled cluster with 1 shard(NumNodeGroups), 1 primary node (implicit) and 2 replicas (replicasPerNodeGroup)\rNumNodeGroups=NumNodeGroups,\rReplicasPerNodeGroup=ReplicasPerNodeGroup,\rCacheParameterGroupName='default.redis6.0.cluster.on'\r)\rreturn response\r# Creates a cluster mode enabled\rresponse = create_cluster_mode_enabled(\rCacheNodeType='cache.m6g.large',\rEngineVersion='6.0',\rReplicationGroupDescription='Redis cluster mode enabled with replicas',\rReplicationGroupId='redis20210',\r# Creates a cluster mode enabled cluster with 1 shard(NumNodeGroups), 1 primary (implicit) and 2 replicas (replicasPerNodeGroup)\rNumNodeGroups=2,\rReplicasPerNodeGroup=1,\r)\rlogging.info(response)\rTo run the program, enter the following command:  python ClusterModeEnabled.py\rIf the program cannot run, use the following command:\npython \u0026quot;file path ClusterModeEnabled.py\u0026quot;\rCreate a cluster (cluster mode enable) with TLS and RBAC To ensure security, you can use Transport Layer Security (TLS) and Role-Based Access Control (RBAC) when creating a cluster (cluster mode enable). Unlike Redis AUTH, where all authenticated clients have full replication group access if their tokens are authenticated, RBAC allows you to control cluster access through user groups. These user groups are designed as a way to organize access to replication groups.\n  Create a python file named ClusterModeEnabledWithRBAC.py\n  Copy the following program and paste it into the file named ClusterModeEnabledWithRBAC.py.\n  import boto3\rimport logging\rlogging.basicConfig(level=logging.INFO)\rclient = boto3.client('elasticache')\rdef create_cluster_mode_enabled(CacheNodeType='cache.t3.small',EngineVersion='6.0',NumNodeGroups=1,ReplicasPerNodeGroup=1, ReplicationGroupDescription='Sample cache with cluster mode enabled',ReplicationGroupId=None,UserGroupIds=None, SecurityGroupIds=None, CacheSubnetGroupName=None,CacheParameterGroupName='default.redis6.0.cluster.on'):\r\u0026quot;\u0026quot;\u0026quot;Creates an Elasticache Cluster with cluster mode enabled and RBAC\rReturns a dictionary with the API response\r:param CacheNodeType: Node type used on the cluster. If not specified, cache.t3.small will be used\rRefer to https://docs..amazon.com/AmazonElastiCache/latest/red-ug/CacheNodes.SupportedTypes.html for supported node types\r:param EngineVersion: Engine version to be used. If not specified, latest will be used.\r:param NumNodeGroups: Number of shards in the cluster. Minimum 1 and maximun 90.\rIf not specified, cluster will be created with 1 shard.\r:param ReplicasPerNodeGroup: Number of replicas per shard. If not specified 1 replica per shard will be created.\r:param ReplicationGroupDescription: Description for the cluster.\r:param ReplicationGroupId: Name for the cluster.\r:param CacheParameterGroupName: Parameter group to be used. Must be compatible with the engine version and cluster mode enabled.\r:return: dictionary with the API results\r\u0026quot;\u0026quot;\u0026quot;\rif not ReplicationGroupId:\rreturn 'ReplicationGroupId parameter is required'\relif not isinstance(UserGroupIds,(list)):\rreturn {'Error': 'UserGroupIds parameter is required and must be a list'}\rparams={'AutomaticFailoverEnabled': True,\r'CacheNodeType': CacheNodeType,\r'Engine': 'redis',\r'EngineVersion': EngineVersion,\r'ReplicationGroupDescription': ReplicationGroupDescription,\r'ReplicationGroupId': ReplicationGroupId,\r'SnapshotRetentionLimit': 30,\r'TransitEncryptionEnabled': True,\r'UserGroupIds':UserGroupIds,\r'NumNodeGroups': NumNodeGroups,\r'ReplicasPerNodeGroup': ReplicasPerNodeGroup,\r'CacheParameterGroupName': CacheParameterGroupName\r}\r# defaults will be used if CacheSubnetGroupName or SecurityGroups are not explicit.\rif isinstance(SecurityGroupIds,(list)):\rparams.update({'SecurityGroupIds':SecurityGroupIds})\rif CacheSubnetGroupName:\rparams.update({'CacheSubnetGroupName':CacheSubnetGroupName})\rresponse = client.create_replication_group(**params)\rreturn response\rif __name__ == '__main__':\r# Creates a cluster mode enabled cluster\rresponse = create_cluster_mode_enabled(\rCacheNodeType='cache.m6g.large',\rEngineVersion='6.0',\rReplicationGroupDescription='Redis cluster mode enabled with replicas',\rReplicationGroupId='redis2021',\r# Creates a cluster mode enabled cluster with 1 shard(NumNodeGroups), 1 primary (implicit) and 2 replicas (replicasPerNodeGroup)\rNumNodeGroups=2,\rReplicasPerNodeGroup=1,\rUserGroupIds=[\r'mygroup'\r],\rSecurityGroupIds=[\r'sg-7cc73803'\r],\rCacheSubnetGroupName='default'\r)\rlogging.info(response)\rTo run the program, enter the following command:  python ClusterModeEnabledWithRBAC.py\rIf the program cannot run, use the following command:\npython \u0026quot;file path ClusterModeEnabledWithRBAC.py\u0026quot;\r"
},
{
	"uri": "/3-amazonelasticacheforredis/3.2-create-a-clustercluster-mode-disabled/",
	"title": "Create cluster (cluster mode disabled)",
	"tags": [],
	"description": "",
	"content": "Overview   Before creating a cluster for use in production, you need to consider how you will configure the cluster to meet your needs. For this lab, you will create a cluster with cluster mode disabled and you will apply default configuration values.\n  The cluster you create will work and not run in the sandbox. You will be charged** ElastiCache standard** usage fee for the example until you delete it. The total fee will be minimal (usually less than a dollar) if you complete the exercise described here in one go and delete your cluster when you\u0026rsquo;re done.\n  Your cluster is launched in a Virtual Private Cloud (VPC) based on the Amazon VPC service.\n  Content  3.2.1 Create a cluster using Console 3.2.2 Create a cluster using AWS CLI  "
},
{
	"uri": "/2-prerequiste/2.2-install-aws-cli/",
	"title": "Install AWS CLI",
	"tags": [],
	"description": "",
	"content": "\rTo update your existing AWS CLI installation on Windows, download a new installer each time you update to overwrite previous versions. AWS CLI is updated regularly. To see when the latest version is released, see the AWS CLI changelog on GitHub.\n\r Download and run the AWS CLI MSI installer for Windows (64-bit)  Alternatively, you can run the command **msiexec** on Windows Command Promt to run the MSI installer.\n\rmsiexec.exe /i https://awscli.amazonaws.com/AWSCLIV2.msi\r To confirm the installation, open the Start menu, search for cmd to open Windows Command Promt, use the command **aws --version** .  aws --version\rIf Windows cannot find the program, you may need to close and reopen the Windows Command Prompt to refresh the path or add the AWS CLI to your path.\n\r"
},
{
	"uri": "/2-prerequiste/",
	"title": "Preparation",
	"tags": [],
	"description": "",
	"content": "Overview Before we start, let\u0026rsquo;s initialize the following related items: generate an Access Key, install and configure the AWS CLI.\nContent:\n 2.1. Generate AWS Access Key 2.2. Install AWS CLI 2.3. AWS CLI Configuration  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.1-create-a-subnet-group/3.1.2-useawscli/",
	"title": "Use AWS CLI",
	"tags": [],
	"description": "",
	"content": "Create subnet group using AWS CLI  At the command prompt, use the command **create-cache-subnet-group** to create a subnet group.   For Linux, macOS, or Unix:  aws elasticache create-cache-subnet-group \\\r--cache-subnet-group-name mysubnetgroup \\\r--cache-subnet-group-description \u0026quot;Testing\u0026quot; \\\r--subnet-ids subnet-53df9c3a\r For Windows:  aws elasticache create-cache-subnet-group ^\r--cache-subnet-group-name mysubnetgroup ^\r--cache-subnet-group-description \u0026quot;Testing\u0026quot; ^\r--subnet-ids subnet-53df9c3a\rThis command will produce output similar to the following:  {\r\u0026quot;CacheSubnetGroup\u0026quot;: {\r\u0026quot;VpcId\u0026quot;: \u0026quot;vpc-37c3cd17\u0026quot;,\r\u0026quot;CacheSubnetGroupDescription\u0026quot;: \u0026quot;Testing\u0026quot;,\r\u0026quot;Subnets\u0026quot;: [\r{\r\u0026quot;SubnetIdentifier\u0026quot;: \u0026quot;subnet-53df9c3a\u0026quot;,\r\u0026quot;SubnetAvailabilityZone\u0026quot;: {\r\u0026quot;Name\u0026quot;: \u0026quot;us-west-2a\u0026quot;\r}\r}\r],\r\u0026quot;CacheSubnetGroupName\u0026quot;: \u0026quot;mysubnetgroup\u0026quot;\r}\r}\r"
},
{
	"uri": "/3-amazonelasticacheforredis/3.2-create-a-clustercluster-mode-disabled/3.2.2-use-aws-cli/",
	"title": "Use AWS CLI",
	"tags": [],
	"description": "",
	"content": "Create a cluster using the AWS CLI The following CLI code creates a Redis (cluster mode disabled) cache cluster with no replicas.\nFor Linux, macOS or Unix:\naws elasticache create-cache-cluster \\\r--cache-cluster-id my-cluster \\\r--cache-node-type cache.r4.large \\\r--engine redis \\\r--engine-version 3.2.4 \\\r--num-cache-nodes 1 \\\r--cache-parameters-group default.redis3.2 \\\r--snapshot-arns arn:aws:s3:::my_bucket/snapshot.rdb\rFor Windows:\naws elasticache create-cache-cluster ^\r--cache-cluster-id my-cluster ^\r--cache-node-type cache.r4.large ^\r--engine redis ^\r--engine-version 3.2.4 ^\r--num-cache-nodes 1 ^\r--cache-parameters-group default.redis3.2 ^\r--snapshot-arns arn:aws:s3:::my_bucket/snapshot.rdb\r"
},
{
	"uri": "/2-prerequiste/2.3-configure-aws-cli/",
	"title": "Configure AWS CLI",
	"tags": [],
	"description": "",
	"content": "The AWS Command Line Interface (AWS CLI) is an open source tool that allows you to interact with AWS services using commands in your command line shell. With minimal configuration, the AWS CLI allows you to start running functional deployment commands equivalent to that provided by the browser-based AWS Management Console from the command prompt in your terminal program :\nLinux shell - Use popular shell programs such as bash, zsh, and tcsh to run commands in Linux or macOS.\nWindows command line - On Windows, run the command at the Windows command prompt or in PowerShell.\nRemotely - Run commands on Amazon Elastic Compute Cloud (Amazon EC2) through a remote terminal program such as PuTTY or SSH, or with AWS Systems Manager.\nAWS Command Line Interface (AWS CLI) configuration steps:\n  Type aws configure at the Windows Command Prompt, then press Enter .\n  AWS CLI outputs lines of text, entering the following information:\n  AWS Access Key ID [None]: AKIAIOSFODNN7EXAMPLE\rAWS Secret Access Key [None]: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\rDefault region name [None]: us-west-2\rDefault output format [None]: ENTER\rIllustrating images: "
},
{
	"uri": "/3-amazonelasticacheforredis/3.3-create-a-clustercluster-mode-enabled/",
	"title": "Create cluster(cluster mode enabled)",
	"tags": [],
	"description": "",
	"content": "Create a Redis (cluster mode enabled) cluster using ElastiCache console   Sign in to the AWS Management Console and open the Amazon ElastiCache console at https://console.aws.amazon.com/elasticache\n  Select Redis cluster from the navigation pane.\n  Select Create Redis cluster.\n  For Cluster settings, complete the following options:   In Choose a cluster creation method, select Configure and create a new cluster  For Cluster mode, select Enabled  For Cluster info, complete the following information:   In Name, enter the name of the cluster you want to create. (Example: my-cluster-enable) In Description, enter a description of your cluster. (Example: create cluster enable)  For Location, select AWS Cloud  For *Cluster settings, complete the following options:   In Engine version, select 6.2 In Port, select 6379 In Parameter groups, select default.redis6.x.cluster.on In Node type, select cache.r6g.large In Number of shards, choose 3 In Replicas per shard, choose 2  For Subnet group settings, complete the following:   In Subnet groups, select Choose existing subnet group Then select the created subnet group 3.1 Create a subnet group In Associated subnets, select Availability Zone and Subnet ID  For Availability Zone placements, complete the following:   In Slots and keyspaces, select Equal distribution In Availability Zone placements, select Specify Availability Zones  Select Next  For Advanced settings, complete the following options:   In Selected security groups, select default security group  For Backup, complete the following options:   Select Enable automatic backups In Backup retention period, select 1 In Backup window, select No preference  For Maintenance, complete the following options:   In Maintenance window, select No preference In the Topic for Amazon SNS notification section, select Amazon Resource Name (ARN)  For Logs, complete the following options:   In Slow logs, select Enable In Log format, select Text In Log destination type, select CloudWatch Logs In Log destination, select Choose existing log group In Log group name, select the created log name  Select Next. Review and select Create  After a few minutes of initialization and cluster creation results (cluster mode enable)  "
},
{
	"uri": "/3-amazonelasticacheforredis/",
	"title": "Create ElastiCache cluster",
	"tags": [],
	"description": "",
	"content": "Content  Create a subnet group Create a cluster (cluster-mode-disabled) Create a cluster (cluster-mode-enabled) Authorize cluster access Connect cluster nodes Deleting a cluster  "
},
{
	"uri": "/3-amazonelasticacheforredis/3.5-connect-to-the-cluster_s-node/3.5.3-finding-endpoints-aws-cli/",
	"title": "Endpoints using AWS CLI",
	"tags": [],
	"description": "",
	"content": "You can use the AWS CLI for Amazon ElastiCache to discover endpoints for nodes, clusters, and replication groups.\n Find endpoints for nodes and clusters (AWS CLI) Find endpoints for replication groups (AWS CLI)  Find Endpoints for Nodes and Clusters (AWS CLI) You can use the AWS CLI to discover endpoints for a cluster and its nodes with the describe-cache-clusters command. For Redis clusters, the command returns the endpoint of the cluster. If you include the optional parameter --show-cache-node-info, the command will also return the endpoints of the individual nodes in the cluster.\nThe following command gets cluster information for single-node Redis (cluster mode disabled) cluster mycluster.\n For Linux, macOS or Unix:  aws elasticache describe-cache-clusters \\\r--cache-cluster-id redis-cluster \\\r--show-cache-node-info\r For Windows:  aws elasticache describe-cache-clusters ^\r--cache-cluster-id redis-cluster ^\r--show-cache-node-info\rThe output from the above should look like this (JSON format).\n{\r\u0026quot;CacheClusters\u0026quot;: [\r{\r\u0026quot;CacheClusterStatus\u0026quot;: \u0026quot;available\u0026quot;,\r\u0026quot;SecurityGroups\u0026quot;: [\r{\r\u0026quot;SecurityGroupId\u0026quot;: \u0026quot;sg-77186e0d\u0026quot;,\r\u0026quot;Status\u0026quot;: \u0026quot;active\u0026quot;\r}\r],\r\u0026quot;CacheNodes\u0026quot;: [\r{\r\u0026quot;CustomerAvailabilityZone\u0026quot;: \u0026quot;us-east-1b\u0026quot;,\r\u0026quot;CacheNodeCreateTime\u0026quot;: \u0026quot;2018-04-25T18:19:28.241Z\u0026quot;,\r\u0026quot;CacheNodeStatus\u0026quot;: \u0026quot;available\u0026quot;,\r\u0026quot;CacheNodeId\u0026quot;: \u0026quot;0001\u0026quot;,\r\u0026quot;Endpoint\u0026quot;: {\r\u0026quot;Address\u0026quot;: \u0026quot;redis-cluster.ameaqx.0001.use1.cache.amazonaws.com\u0026quot;,\r\u0026quot;Port\u0026quot;: 6379\r},\r\u0026quot;ParameterGroupStatus\u0026quot;: \u0026quot;in-sync\u0026quot;\r}\r],\r\u0026quot;AtRestEncryptionEnabled\u0026quot;: false,\r\u0026quot;CacheClusterId\u0026quot;: \u0026quot;redis-cluster\u0026quot;,\r\u0026quot;TransitEncryptionEnabled\u0026quot;: false,\r\u0026quot;CacheParameterGroup\u0026quot;: {\r\u0026quot;ParameterApplyStatus\u0026quot;: \u0026quot;in-sync\u0026quot;,\r\u0026quot;CacheNodeIdsToReboot\u0026quot;: [],\r\u0026quot;CacheParameterGroupName\u0026quot;: \u0026quot;default.redis3.2\u0026quot;\r},\r\u0026quot;NumCacheNodes\u0026quot;: 1,\r\u0026quot;PreferredAvailabilityZone\u0026quot;: \u0026quot;us-east-1b\u0026quot;,\r\u0026quot;AutoMinorVersionUpgrade\u0026quot;: true,\r\u0026quot;Engine\u0026quot;: \u0026quot;redis\u0026quot;,\r\u0026quot;AuthTokenEnabled\u0026quot;: false,\r\u0026quot;PendingModifiedValues\u0026quot;: {},\r\u0026quot;PreferredMaintenanceWindow\u0026quot;: \u0026quot;tue:08:30-tue:09:30\u0026quot;,\r\u0026quot;CacheSecurityGroups\u0026quot;: [],\r\u0026quot;CacheSubnetGroupName\u0026quot;: \u0026quot;default\u0026quot;,\r\u0026quot;CacheNodeType\u0026quot;: \u0026quot;cache.t2.small\u0026quot;,\r\u0026quot;DataTiering\u0026quot;: \u0026quot;disabled\u0026quot;\r\u0026quot;EngineVersion\u0026quot;: \u0026quot;3.2.10\u0026quot;,\r\u0026quot;ClientDownloadLandingPage\u0026quot;: \u0026quot;https://console.aws.amazon.com/elasticache/home#client-download:\u0026quot;,\r\u0026quot;CacheClusterCreateTime\u0026quot;: \u0026quot;2018-04-25T18:19:28.241Z\u0026quot;\r}\r]\r}\rFinding the Endpoints for Replication Groups (AWS CLI) You can use the AWS CLI to discover endpoints for a replication group and its clusters with the describe-replication-groups command. The command returns the primary endpoint of the replication group and a list of all clusters (nodes) in the replication group with their endpoints, along with the reader endpoint.\nThe following operation retrieves the primary endpoint and reader endpoint of the replication group myreplgroup. Use the primary endpoint for all write operations.\naws elasticache describe-replication-groups \\\r--replication-group-id myreplgroup\rFor Windows:\naws elasticache describe-replication-groups ^\r--replication-group-id myreplgroup\rThe output from this operation should look something like this (JSON format).\n{\r\u0026quot;ReplicationGroups\u0026quot;: [\r{\r\u0026quot;Status\u0026quot;: \u0026quot;available\u0026quot;,\r\u0026quot;Description\u0026quot;: \u0026quot;test\u0026quot;,\r\u0026quot;NodeGroups\u0026quot;: [\r{\r\u0026quot;Status\u0026quot;: \u0026quot;available\u0026quot;,\r\u0026quot;NodeGroupMembers\u0026quot;: [\r{\r\u0026quot;CurrentRole\u0026quot;: \u0026quot;primary\u0026quot;,\r\u0026quot;PreferredAvailabilityZone\u0026quot;: \u0026quot;us-west-2a\u0026quot;,\r\u0026quot;CacheNodeId\u0026quot;: \u0026quot;0001\u0026quot;,\r\u0026quot;ReadEndpoint\u0026quot;: {\r\u0026quot;Port\u0026quot;: 6379,\r\u0026quot;Address\u0026quot;: \u0026quot;myreplgroup-001.1abc4d.0001.usw2.cache.amazonaws.com\u0026quot;\r},\r\u0026quot;CacheClusterId\u0026quot;: \u0026quot;myreplgroup-001\u0026quot;\r},\r{\r\u0026quot;CurrentRole\u0026quot;: \u0026quot;replica\u0026quot;,\r\u0026quot;PreferredAvailabilityZone\u0026quot;: \u0026quot;us-west-2b\u0026quot;,\r\u0026quot;CacheNodeId\u0026quot;: \u0026quot;0001\u0026quot;,\r\u0026quot;ReadEndpoint\u0026quot;: {\r\u0026quot;Port\u0026quot;: 6379,\r\u0026quot;Address\u0026quot;: \u0026quot;myreplgroup-002.1abc4d.0001.usw2.cache.amazonaws.com\u0026quot;\r},\r\u0026quot;CacheClusterId\u0026quot;: \u0026quot;myreplgroup-002\u0026quot;\r},\r{\r\u0026quot;CurrentRole\u0026quot;:"
},
{
	"uri": "/4-sdkelasticache/4.3-set-and-get-strings/",
	"title": "Set and Get strings",
	"tags": [],
	"description": "",
	"content": "Set and Get strings  Create a python file named ConnectClusterModeEnabled.py. Copy the following program and paste it into the file named ConnectClusterModeEnabled.py.  import time\rimport logging\rlogging.basicConfig(level=logging.INFO,format='%(asctime)s: %(message)s')\rkeyName='mykey'\rcurrTime=time.ctime(time.time())\r# Set the key 'mykey' with the current date and time as value.\r# The Key will expire and removed from cache in 60 seconds.\rredis.set(keyName, currTime, ex=60)\r# Sleep just for better illustration of TTL (expiration) value\rtime.sleep(5)\r# Retrieve the key value and current TTL\rkeyValue=redis.get(keyName)\rkeyTTL=redis.ttl(keyName)\rlogging.info(\u0026quot;Key {} was set at {} and has {} seconds until expired\u0026quot;.format(keyName, keyValue, keyTTL))\rTo run the program, enter the following command:  python SetAndGetStrings.py\rIf the program cannot run, use the following command:\npython \u0026quot;SetAndGetStrings.py file path\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/4.1-creating-elasticache-clusters-and-users/4.1.3-check-if-users/",
	"title": "Test user group",
	"tags": [],
	"description": "",
	"content": "With RBAC, you create users and assign them specific permissions using an access string. You assign users to user groups that match a specific role (admin, human resources) which are then deployed to one or more ElastiCache for Redis replication groups. This way, you can establish security boundaries between clients using the same Redis replication group or pool and prevent the clients from accessing each other\u0026rsquo;s data.\n Create a python file named UserAndUserGroups.py Copy the following program and paste it into the file named UserAndUserGroups.py.  import boto3\rimport logging\rlogging.basicConfig(level=logging.INFO)\rclient = boto3.client('elasticache')\rdef check_user_exists(UserId):\r\u0026quot;\u0026quot;\u0026quot;Checks if UserId exists\rReturns True if UserId exists, otherwise False\r:param UserId: Elasticache User ID\r:return: True|False\r\u0026quot;\u0026quot;\u0026quot;\rtry:\rresponse = client.describe_users(\rUserId=UserId,\r)\rif response['Users'][0]['UserId'].lower() == UserId.lower():\rreturn True\rexcept Exception as e:\rif e.response['Error']['Code'] == 'UserNotFound':\rlogging.info(e.response['Error'])\rreturn False\relse:\rraise\rdef check_group_exists(UserGroupId):\r\u0026quot;\u0026quot;\u0026quot;Checks if UserGroupID exists\rReturns True if Group ID exists, otherwise False\r:param UserGroupId: Elasticache User ID\r:return: True|False\r\u0026quot;\u0026quot;\u0026quot;\rtry:\rresponse = client.describe_user_groups(\rUserGroupId=UserGroupId\r)\rif response['UserGroups'][0]['UserGroupId'].lower() == UserGroupId.lower():\rreturn True\rexcept Exception as e:\rif e.response['Error']['Code'] == 'UserGroupNotFound':\rlogging.info(e.response['Error'])\rreturn False\relse:\rraise\rdef create_user(UserId=None,UserName=None,Password=None,AccessString=None):\r\u0026quot;\u0026quot;\u0026quot;Creates a new user\rReturns the ARN for the newly created user or the error message\r:param UserId: Elasticache user ID. User IDs must be unique\r:param UserName: Elasticache user name. Elasticache allows multiple users with the same name as long as the associated user ID is unique.\r:param Password: Password for user. Must have at least 16 chars.\r:param AccessString: Access string with the permissions for the user. For details refer to https://docs..amazon.com/AmazonElastiCache/latest/red-ug/Clusters.RBAC.html#Access-string\r:return: user ARN\r\u0026quot;\u0026quot;\u0026quot;\rtry:\rresponse = client.create_user(\rUserId=UserId,\rUserName=UserName,\rEngine='Redis',\rPasswords=[Password],\rAccessString=AccessString,\rNoPasswordRequired=False\r)\rreturn response['ARN']\rexcept Exception as e:\rlogging.info(e.response['Error'])\rreturn e.response['Error']\rdef create_group(UserGroupId=None, UserIds=None):\r\u0026quot;\u0026quot;\u0026quot;Creates a new group.\rA default user is required (mandatory) and should be specified in the UserIds list\rReturn: Group ARN\r:param UserIds: List with user IDs to be associated with the new group. A default user is required\r:param UserGroupId: The ID (name) for the group\r:return: Group ARN\r\u0026quot;\u0026quot;\u0026quot;\rtry:\rresponse = client.create_user_group(\rUserGroupId=UserGroupId,\rEngine='Redis',\rUserIds=UserIds\r)\rreturn response['ARN']\rexcept Exception as e:\rlogging.info(e.response['Error'])\rif __name__ == '__main__':\rgroupName='mygroup2'\ruserName = 'myuser2'\ruserId=groupName+'-'+userName\r# Creates a new user if the user ID does not exist.\rfor tmpUserId,tmpUserName in [ (userId,userName), (groupName+'-default','default')]:\rif not check_user_exists(tmpUserId):\rresponse=create_user(UserId=tmpUserId, UserName=tmpUserName,Password='MyStrongPasswordWithNumbers',AccessString='on ~* +@all')\rlogging.info(response)\r# assigns the new user ID to the user group\rif not check_group_exists(groupName):\rUserIds = [ userId , groupName+'-default']\rresponse=create_group(UserGroupId=groupName,UserIds=UserIds)\rlogging.info(response)\rTo run the program, enter the following command:  python UserAndUserGroups.py\rIf the program cannot run, use the following command:\npython \u0026quot;UserAndUserGroups.py file path\u0026quot;\r"
},
{
	"uri": "/3-amazonelasticacheforredis/3.4-grantaccesstocluster/",
	"title": "Grant access to the cluster",
	"tags": [],
	"description": "",
	"content": "\rAll ElastiCache clusters are designed to be accessible from an Amazon EC2 instance. The most common scenario is accessing an ElastiCache cluster from an Amazon EC2 instance in the same Virtual Private Cloud (VPC), which will be the case for this lab.\n\rBy default, access to your cluster is limited to the user account that was used to create it. Before you can connect to a cluster from an EC2 instance, you must allow the EC2 instance to access the cluster. The required steps depend on whether you are launching your cluster into EC2-VPC or EC2-Classic.\nThe most common use case is when an application deployed on an EC2 instance needs to connect to a cluster in the same VPC. The simplest way to manage access between EC2 instances and clusters within the same VPC is to do the following:\nCreate a Security Group VPC for your cluster. This Security Group can be used to restrict access to cluster instances. For example, you can create a custom rule for this Security Group that allows TCP access using the port you specified for the cluster when you created it and an IP address you will use to access the cluster.\nThe default port for Redis clusters and replicas group is 6379.\nTo create a rule in Security Group VPC that allows connections from another Security Group\n  Sign in to the AWS Management Console and open the Amazon VPC console at https://console.aws.amazon.com/vpc.\n  Select Security Groups.\n  Select or create a security group that you will use for Cluster instances.\n  In Inbound Rules, select Edit Inbound Rules\n  5. then select Add Rule. This security group will allow access to members of other security groups.\n6. For Type, select Custom TCP Rule\n  For Port Range, specify the port you used when you created your cluster.\n  The default gateway for Redis clusters and replication groups is 6379.\n  In the Source box, start entering the ID of the security group. From the list, select the security group you will use for your Amazon EC2 instances.\n  Select Save rule when you\u0026rsquo;re done.  "
},
{
	"uri": "/4-sdkelasticache/4.4-set-and-get-a-hash-with-multiple-items/",
	"title": "Set and Get a hash with multiple items",
	"tags": [],
	"description": "",
	"content": " Create a python file named SetAndGetHash.py Copy the following program and paste it into the file named SetAndGetHash.py.  import logging\rimport time\rlogging.basicConfig(level=logging.INFO,format='%(asctime)s: %(message)s')\rkeyName='mykey'\rkeyValues={'datetime': time.ctime(time.time()), 'epochtime': time.time()}\r# Set the hash 'mykey' with the current date and time in human readable format (datetime field) and epoch number (epochtime field).\rredis.hset(keyName, mapping=keyValues)\r# Set the key to expire and removed from cache in 60 seconds.\rredis.expire(keyName, 60)\r# Sleep just for better illustration of TTL (expiration) value\rtime.sleep(5)\r# Retrieves all the fields and current TTL\rkeyValues=redis.hgetall(keyName)\rkeyTTL=redis.ttl(keyName)\rlogging.info(\u0026quot;Key {} was set at {} and has {} seconds until expired\u0026quot;.format(keyName, keyValues, keyTTL))\rTo run the program, enter the following command:  python SetAndGetHash.py\rIf the program cannot run, use the following command:\npython \u0026quot;SetAndGetHash.py file path\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/",
	"title": "Using AWS SDK to write and read data on ElastiCache",
	"tags": [],
	"description": "",
	"content": "Overview In this tutorial, you use the AWS SDK for Python (Boto3) to write simple programs that perform the following ElastiCache operations:\n  Create ElastiCache cluster (cluster mode disable and cluster mode enable)\n  Check if user or user group exists, if not create the user (Redis 6.0 onwards only)\n  Connect with ElastiCache\n  Perform operations such as set up and get strings, read and write to steam, and publish and subscribe from a Pub/Sub channel.\n  Prepare\n  Set up AWS Access Key to use AWS SDK.\n  Install Python 3.0 or later. For more information see https://www.python.org/downloads.\n  Content  Create Cluster Connect node Set and get string Publish and subscriber Write and read from a stream  "
},
{
	"uri": "/5.cleanupresource/",
	"title": "Clean up resources",
	"tags": [],
	"description": "",
	"content": "Delete a cluster using Console   Sign in to the AWS Management Console and open the Amazon ElastiCache console at https://console.aws.amazon.com/elasticache/.\n  In the ElastiCache console dashboard, select Redis clusters. A list of all clusters running Redis appears.\n  To select the cluster to delete, select the name of the cluster from the list of clusters. In this case, the name of the cluster you created in 3.2: Create cluster .\n  For Actions, select Delete.\n  In the Delete Cluster confirmation screen, select Delete to delete the cluster or select Cancel to keep the cluster.  If you select Delete, the cluster\u0026rsquo;s state will change to deleting.\nAs soon as your cluster is no longer listed in the list of clusters, you will stop charging for that cluster.\nDelete a cluster using the AWS CLI The following code will clear the cluster cache my-cluster. In this case, replace my-cluster with the name of the cluster you created at [3.2: Create cluster](../3.2-Create%20a%20cluster/3.2.2-Use%20AWS%20CLI /_index.md).\naws elasticache delete-cache-cluster --cache-cluster-id my-cluster\rThe delete-cache-cluster CLI action deletes only one cache cluster. To delete multiple cache clusters, call delete-cache-cluster each cache cluster that you want to delete. You don\u0026rsquo;t have to wait for one cache cluster to finish deleting before deleting another cache cluster.\nFor Linux, macOS or Unix:\naws elasticache delete-cache-cluster \\\r--cache-cluster-id my-cluster \\\r--region us-east-2\rFor Windows:\naws elasticache delete-cache-cluster ^\r--cache-cluster-id my-cluster ^\r--region us-east-2\r"
},
{
	"uri": "/3-amazonelasticacheforredis/3.5-connect-to-the-cluster_s-node/",
	"title": "Connect to cluster node",
	"tags": [],
	"description": "",
	"content": "Overview Your application connects to your cluster using endpoints. endpoint is the unique address of the node or cluster.\n Redis standalone node, which uses the node\u0026rsquo;s endpoint for both read and write operations. Redis (cluster mode disabled) clusters, which use the primary endpoint for all write operations. Use the reader endpoint to equally split connections to the endpoint between all read replicas. Use individual endpoint nodes for read operations (In the API/CLI these are called reader endpoints). Redis (cluster mode enabled) clusters, which use the cluster\u0026rsquo;s configuration endpoint for all operations that support commands (cluster mode enable). You must use a client that supports Redis Cluster (Redis 3.2). You can still read from individual endpoint nodes (In the API/CLI these are called reader endpoints).  Content  Cluster Mode Disable Cluster Mode Enable Enpoint using AWS CLI  "
},
{
	"uri": "/4-sdkelasticache/4.5-publish-and-subscriber/",
	"title": "Publish (write) and subscribe (read)",
	"tags": [],
	"description": "",
	"content": " Create a python file named PubAndSub.py Copy the following program and paste it into the file named PubAndSub.py.  import logging\rimport time\rdef handlerFunction(message):\r\u0026quot;\u0026quot;\u0026quot;Prints message got from PubSub channel to the log output\rReturn None\r:param message: message to log\r\u0026quot;\u0026quot;\u0026quot;\rlogging.info(message)\rlogging.basicConfig(level=logging.INFO)\rredis = Redis(host=\u0026quot;redis202104053.tihewd.ng.0001.use1.cache.amazonaws.com\u0026quot;, port=6379, decode_responses=True)\r# Creates the subscriber connection on \u0026quot;mychannel\u0026quot;\rsubscriber = redis.pubsub()\rsubscriber.subscribe(**{'mychannel': handlerFunction})\r# Creates a new thread to watch for messages while the main process continues with its routines\rthread = subscriber.run_in_thread(sleep_time=0.01)\r# Creates publisher connection on \u0026quot;mychannel\u0026quot;\rredis.publish('mychannel', 'My message')\r# Publish several messages. Subscriber thread will read and print on log.\rwhile True:\rredis.publish('mychannel',time.ctime(time.time()))\rtime.sleep(1)\rTo run the program, enter the following command:  python PubAndSub.py\rIf the program cannot run, use the following command:\npython \u0026quot;PubAndSub.py file path\u0026quot;\r"
},
{
	"uri": "/4-sdkelasticache/4.6-write-and-read-from-a-stream/",
	"title": "Write and read from a stream",
	"tags": [],
	"description": "",
	"content": " Create a python file named ReadWriteStream.py Copy the following program and paste it into a file named ReadWriteStream.py .  from redis import Redis\rimport redis.exceptions as exceptions\rimport logging\rimport time\rimport threading\rlogging.basicConfig(level=logging.INFO)\rdef writeMessage(streamName):\r\u0026quot;\u0026quot;\u0026quot;Starts a loop writing the current time and thread name to 'streamName'\r:param streamName: Stream (key) name to write messages.\r\u0026quot;\u0026quot;\u0026quot;\rfieldsDict={'writerId':threading.currentThread().getName(),'myvalue':None}\rwhile True:\rfieldsDict['myvalue'] = time.ctime(time.time())\rredis.xadd(streamName,fieldsDict)\rtime.sleep(1)\rdef readMessage(groupName=None,streamName=None):\r\u0026quot;\u0026quot;\u0026quot;Starts a loop reading from 'streamName'\rMultiple threads will read from the same stream consumer group. Consumer group is used to coordinate data distribution.\rOnce a thread acknowleges the message, it won't be provided again. If message wasn't acknowledged, it can be served to another thread.\r:param groupName: stream group were multiple threads will read.\r:param streamName: Stream (key) name where messages will be read.\r\u0026quot;\u0026quot;\u0026quot;\rreaderID=threading.currentThread().getName()\rwhile True:\rtry:\r# Check if the stream has any message\rif redis.xlen(streamName)\u0026gt;0:\r# Check if if the messages are new (not acknowledged) or not (already processed)\rstreamData=redis.xreadgroup(groupName,readerID,{streamName:'\u0026gt;'},count=1)\rif len(streamData) \u0026gt; 0:\rmsgId,message = streamData[0][1][0]\rlogging.info(\u0026quot;{}: Got {} from ID {}\u0026quot;.format(readerID,message,msgId))\r#Do some processing here. If the message has been processed sucessfuly, acknowledge it and (optional) delete the message.\rredis.xack(streamName,groupName,msgId)\rlogging.info(\u0026quot;Stream message ID {} â€‹â€‹read and successfuly by {}\u0026quot;.format(msgId,readerID))\rredis.xdel(streamName,msgId)\relse:\rpass\rexcept:\rraise\rtime.sleep(0.5)\r# Creates the stream 'mystream' and consumer group 'myworkergroup' where multiple threads will write/read.\rtry:\rredis.xgroup_create('mystream','myworkergroup',mkstream=True)\rexcept exceptions.ResponseError as e:\rlogging.info(\u0026quot;Consumer group already exists. Will continue despite the error: {}\u0026quot;.format(e))\rexcept:\rraise\r# Starts 5 writer threads.\rfor writer_no in range(5):\rwriterThread = threading.Thread(target=writeMessage, name='writer-'+str(writer_no), args=('mystream',),daemon=True)\rwriterThread.start()\r# Starts 10 reader threads\rfor reader_no in range(10):\rreaderThread = threading.Thread(target=readMessage, name='reader-'+str(reader_no), args=('myworkergroup','mystream',),daemon=True)\rreaderThread.daemon = True\rreaderThread.start()\r# Keep the code running for 30 seconds\rtime.sleep(30)\rTo run the program, enter the following command:  python ReadWriteStream.py\rIf the program cannot run, use the following command:\npython \u0026quot;ReadWriteStream.py file path\u0026quot;\r"
},
{
	"uri": "/3-amazonelasticacheforredis/3.6-deleting-a-cluster/3.6.1-use-console/",
	"title": "",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/3-amazonelasticacheforredis/3.6-deleting-a-cluster/3.6.2-use-aws-cli/",
	"title": "",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/3-amazonelasticacheforredis/3.6-deleting-a-cluster/",
	"title": "",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/categories/",
	"title": "Categories",
	"tags": [],
	"description": "",
	"content": ""
},
{
	"uri": "/tags/",
	"title": "Tags",
	"tags": [],
	"description": "",
	"content": ""
}]